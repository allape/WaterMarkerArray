(this["webpackJsonpwater-marker-array"]=this["webpackJsonpwater-marker-array"]||[]).push([[0],{102:function(e,a,t){},104:function(e,a,t){},116:function(e,a,t){"use strict";t.r(a);var n,r=t(0),c=t.n(r),l=t(37),i=t.n(l),o=(t(102),t(14)),s=t(16),u=t.n(s),b=t(25),f=t(10),j=(t(104),t(167)),d=t(168),p=t(161),O=t(162),h=t(158),m=t(159),g=t(163),v=t(160),x=t(171),w=t(172),L=t(88),y=t(18),S=t(79),k=t.n(S),C=t(166),z=t(3),W=t(51),I=t(41),N=t(81),F=t(82),P=t(66),B=t(67),T={en:{name:"English",language:"en",resource:F},zh:{name:"\u4e2d\u6587",language:"zh",resource:P},"zh-CN":{name:"\u7b80\u4f53\u4e2d\u6587",language:"zh-CN",resource:P},"zh-TW":{name:"\u7e41\u9ad4\u4e2d\u6587(\u53f0\u7063)",language:"zh-TW",resource:B},"zh-HK":{name:"\u7e41\u9ad4\u4e2d\u6587(\u9999\u6e2f)",language:"zh-HK",resource:B}},D=null===(n=window.navigator)||void 0===n?void 0:n.language,E=D&&Object.keys(T).includes(D)?D:T.en.language,M=Object.values(T);W.a.use(I.e).use(N.a).init({fallbackLng:T.en.language,interpolation:{escapeValue:!1},resources:Object.values(T).reduce((function(e,a){return Object(o.a)(Object(o.a)({},e),{},Object(z.a)({},a.language,{translation:a.resource}))}),{})}).then(Object(b.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.a.changeLanguage(E);case 2:console.log("i18n:",W.a);case 3:case"end":return e.stop()}}),e)}))));var A=W.a,R={A3:{width:297,height:420},A4:{width:210,height:297},A5:{width:148,height:210},B4:{width:250,height:353},B5:{width:176,height:250}},J=Object.keys(R).map((function(e){return{value:e,label:e}})),Q=[{value:200,label:"200ppi"},{value:300,label:"300ppi"},{value:600,label:"600ppi"},{value:1200,label:"1200ppi"}],U=self||window;function q(e){return H.apply(this,arguments)}function H(){return(H=Object(b.a)(u.a.mark((function e(a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return","createImageBitmap"in U?createImageBitmap(a):new Promise((function(e){var t=document.createElement("img");t.onload=function(){return e(t)},t.src=URL.createObjectURL(a)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,a){var t=R[a.paperSize],n=25.4/a.precision,r=t.width/n,c=t.height/n;if(null==e){if(!("OffscreenCanvas"in U))throw new Error("Current browser does NOT support OffscreenCanvas, you have to provide a Canvas Object to render.");e=new OffscreenCanvas(r,c)}else e.width=r,e.height=c;var l=e.getContext("2d"),i=a.fontSize/n,o=a.rowSpace/n,s=a.colSpace/n,u=a.rowShift/n,b=2*Math.max(r,c),f=r/2,j=c/2,d=-b/2,p=-b/2;l.fillStyle="#ffffff",l.clearRect(d+f,p+j,b,b),a.image&&l.drawImage(a.image.bitmap,0,0,r,c),l.translate(f,j),l.rotate(a.rotate*Math.PI/180),l.translate(d,p);var O=a.text;l.font="".concat(a.fontWeight||"normal"," ").concat(i,"px ").concat(a.fontFamily||"serif"),l.textBaseline="middle";var h=l.measureText(O),m=h.width,g=h.fontBoundingBoxAscent+h.fontBoundingBoxDescent;l.fillStyle=a.color;for(var v=0,x=0,w=0;x<=b;){if(v>b+u*w){var L=g+s;l.translate(-u,L),v=-u*w,x+=L,w++}l.fillText(O,v,0),v+=m+o}return e}var V=t(85),X=t(2),Y="CanvasContainer",_={className:"form-item-wrapper",spacing:2,direction:"row",alignItems:"center"};function G(){var e=Object(C.a)(),a=e.t,t=e.i18n,n=Object(V.a)(),c=n.loading,l=n.load,i=n.loaded,s=n.isLoading,S=Object(r.useState)(E),z=Object(f.a)(S,2),W=z[0],I=z[1],N=Object(r.useCallback)(function(){var e=Object(b.a)(u.a.mark((function e(a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.changeLanguage(a);case 2:I(a);case 3:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),[t]);Object(r.useEffect)((function(){window.document.title=a("title")}),[a,t.language]);var F=Object(y.b)(J[1].value),P=Object(f.a)(F,4),B=P[0],T=P[2],D=P[3],A=Object(y.b)(Q[1].value),R=Object(f.a)(A,4),U=R[0],H=R[2],G=R[3],Z=Object(y.b)((new Date).toLocaleDateString()),$=Object(f.a)(Z,4),ee=$[0],ae=$[2],te=$[3],ne=Object(y.b)("rgba(0, 0, 0, 0.1)"),re=Object(f.a)(ne,4),ce=re[0],le=re[2],ie=re[3],oe=Object(y.b)("serif"),se=Object(f.a)(oe,4),ue=se[0],be=se[2],fe=se[3],je=Object(y.b)(6),de=Object(f.a)(je,4),pe=de[0],Oe=de[2],he=de[3],me=Object(y.b)("400"),ge=Object(f.a)(me,4),ve=ge[0],xe=ge[2],we=ge[3],Le=Object(y.b)(10),ye=Object(f.a)(Le,4),Se=ye[0],ke=ye[2],Ce=ye[3],ze=Object(y.b)(10),We=Object(f.a)(ze,4),Ie=We[0],Ne=We[2],Fe=We[3],Pe=Object(y.b)(315),Be=Object(f.a)(Pe,4),Te=Be[0],De=Be[2],Ee=Be[3],Me=Object(y.b)(10),Ae=Object(f.a)(Me,4),Re=Ae[0],Je=Ae[2],Qe=Ae[3],Ue=Object(y.b)(),qe=Object(f.a)(Ue,4),He=qe[0],Ke=qe[2],Ve=qe[3],Xe=Object(y.a)(void 0),Ye=Object(f.a)(Xe,1)[0],_e=Object(y.a)(!1),Ge=Object(f.a)(_e,1)[0],Ze=Object(y.a)(!1),$e=Object(f.a)(Ze,1)[0],ea=Object(r.useCallback)((function(){return{paperSize:T.value,precision:H.value,text:ae.value,color:le.value,fontFamily:be.value,fontSize:Oe.value,fontWeight:xe.value,rowSpace:ke.value,colSpace:Ne.value,rotate:De.value,rowShift:Je.value,image:Ke.value}}),[T,H,ae,le,be,Oe,xe,ke,Ne,De,Je,Ke]),aa=Object(y.a)({paperSize:"",precision:-1,text:"",color:"",fontFamily:"",fontSize:-1,fontWeight:"",rowSpace:-1,colSpace:-1,rotate:-1,rowShift:-1}),ta=Object(f.a)(aa,1)[0],na=Object(r.useCallback)((function(e){var a=ta.value,t=Object(o.a)(Object(o.a)({},ea()),e);return a.paperSize!==t.paperSize||a.precision!==t.precision||a.text!==t.text||a.color!==t.color||a.fontFamily!==t.fontFamily||a.fontSize!==t.fontSize||a.fontWeight!==t.fontWeight||a.rowSpace!==t.rowSpace||a.colSpace!==t.colSpace||a.rotate!==t.rotate||a.rowShift!==t.rowShift}),[ta,ea]),ra=Object(r.useCallback)(Object(b.a)(u.a.mark((function e(){var a,t,n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!$e.value){e.next=2;break}return e.abrupt("return");case 2:if(a=!1,e.prev=3,Ge.value=!0,console.log("render at",(new Date).toLocaleTimeString()),Ye.value){e.next=19;break}if(!(t=document.getElementById(Y))){e.next=14;break}Ye.value=document.createElement("canvas"),Ye.value.style.width="100%",t.append(Ye.value),e.next=17;break;case 14:return a=!0,requestAnimationFrame(ra),e.abrupt("return");case 17:e.next=25;break;case 19:n=Ye.value,r={precision:100},c=Object(o.a)(Object(o.a)({},ea()),r),K(n,c),ta.value=c,na(r)&&(a=!0,requestAnimationFrame(ra));case 25:return e.prev=25,Ge.value=a,e.finish(25);case 28:case"end":return e.stop()}}),e,null,[[3,,25,28]])}))),[$e,Ge,Ye,ta,na,ea]);Object(r.useEffect)((function(){return ra().then(),function(){$e.value=!0}}),[ra,$e]),Object(r.useEffect)((function(){Ge.value||ra().then()}),[ra,Ge,B,U,ee,ce,ue,pe,ve,Se,Ie,Te,Re,He]);var ca=Object(r.useCallback)(function(){var e=Object(b.a)(u.a.mark((function e(a){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.target.files&&a.target.files.length>0)){e.next=19;break}return t=l(),e.prev=2,e.t0=Ve,e.t1=q,e.t2=Blob,e.next=8,a.target.files[0].arrayBuffer();case 8:return e.t3=e.sent,e.t4=[e.t3],e.t5=new e.t2(e.t4),e.next=13,(0,e.t1)(e.t5);case 13:e.t6=e.sent,e.t7={bitmap:e.t6},(0,e.t0)(e.t7);case 16:return e.prev=16,i(t),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[2,,16,19]])})));return function(a){return e.apply(this,arguments)}}(),[Ve,l,i]),la=Object(r.useCallback)(Object(b.a)(u.a.mark((function e(){var a,t,n,r,c=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=c.length>0&&void 0!==c[0]?c[0]:"image/png",t=!(c.length>1&&void 0!==c[1])||c[1],n=ea(),!(window.Worker&&"OffscreenCanvas"in window&&t)){e.next=7;break}return e.abrupt("return",new Promise((function(e){var t=l(),r=function(){var t=Object(b.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,la(a,!1);case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();try{var c={type:"draw",data:Object(o.a)(Object(o.a)({},n),{},{type:a})},s=new Worker("".concat("/WaterMarkerArray","/core.worker.js"));s.postMessage(c),s.onmessage=function(a){switch(a.data.type){case"then":e(a.data.data);break;case"catch":console.error("error in worker response:",a.data.data),r();break;case"finally":i(t)}}}catch(f){console.error("error on creating worker:",f),r()}})));case 7:return r=K(document.createElement("canvas"),n),e.abrupt("return",r.toDataURL(a,1));case 9:case"end":return e.stop()}}),e)}))),[ea,l,i]),ia=Object(r.useCallback)(Object(b.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=k.a,e.next=3,la();case 3:e.t1=e.sent,e.t2={printable:e.t1,type:"image",style:"@media print { body { margin: 0; padding: 0; } }"},(0,e.t0)(e.t2);case 6:case"end":return e.stop()}}),e)}))),[la]),oa=Object(r.useState)(),sa=Object(f.a)(oa,2),ua=sa[0],ba=sa[1],fa=Object(r.useCallback)((function(e){e.preventDefault(),s()||ba((function(a){return a?void 0:{left:e.clientX-2,top:e.clientY-4}}))}),[s]),ja=Object(r.useCallback)((function(){ba(void 0)}),[]),da=Object(r.useCallback)((function(){ia().then(),ja()}),[ia,ja]),pa=Object(r.useCallback)(Object(b.a)(u.a.mark((function e(){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=document.createElement("a")).target="_blank",a.download="".concat(ae.value||"image",".png"),e.next=5,la("image/octet-stream");case 5:a.href=e.sent,a.click(),ja();case 8:case"end":return e.stop()}}),e)}))),[ae,la,ja]);return Object(r.useEffect)((function(){ja()}),[c,ja]),Object(X.jsxs)("div",{className:"app-wrapper",children:[Object(X.jsxs)(j.a,{className:"paper form-wrapper ".concat(a("form.style.i18nClass")),children:[Object(X.jsxs)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:[Object(X.jsxs)(p.a,{variant:"standard",fullWidth:!0,children:[Object(X.jsx)(O.a,{id:"LanguageLabel",children:a("form.languageLabel")}),Object(X.jsx)(h.a,{labelId:"LanguageLabel",disabled:c,value:W,onChange:function(e){return N(e.target.value)},children:M.map((function(e){return Object(X.jsx)(m.a,{value:e.language,children:e.name},e.language)}))})]}),Object(X.jsxs)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:[Object(X.jsxs)(p.a,{variant:"standard",fullWidth:!0,children:[Object(X.jsx)(O.a,{id:"PaperSizeLabel",children:a("form.paperSizeLabel")}),Object(X.jsx)(h.a,{labelId:"PaperSizeLabel",disabled:c,value:B,onChange:function(e){return D(e.target.value)},children:J.map((function(e){return Object(X.jsx)(m.a,{value:e.value,children:e.label},e.value)}))})]}),Object(X.jsxs)(p.a,{variant:"standard",fullWidth:!0,children:[Object(X.jsx)(O.a,{id:"PrecisionLabel",children:a("form.printQuality")}),Object(X.jsx)(h.a,{labelId:"PrecisionLabel",disabled:c,value:U,onChange:function(e){return G(e.target.value)},children:Q.map((function(e){return Object(X.jsx)(m.a,{value:e.value,children:e.label},e.value)}))})]})]}))]})),Object(X.jsx)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:Object(X.jsx)(g.a,{fullWidth:!0,label:a("form.waterMarkerText"),variant:"standard",disabled:c,value:ee,onChange:function(e){return te(e.target.value)}})})),Object(X.jsxs)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:[Object(X.jsx)(g.a,{fullWidth:!0,label:a("form.font.familyLabel"),variant:"standard",value:ue,disabled:c,onChange:function(e){return fe(e.target.value)}}),Object(X.jsx)(g.a,{fullWidth:!0,type:"number",label:a("form.font.weightLabel"),variant:"standard",value:ve,disabled:c,onChange:function(e){return we(e.target.value)}})]})),Object(X.jsxs)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:[Object(X.jsx)(g.a,{fullWidth:!0,label:a("form.font.colorLabel"),variant:"standard",value:ce,disabled:c,onChange:function(e){return ie(e.target.value)}}),Object(X.jsxs)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:[Object(X.jsxs)("div",{className:"form-item-name",children:[a("form.font.sizeLabel")," (mm):"]}),Object(X.jsx)(v.a,{"aria-label":a("form.font.sizeLabel"),valueLabelDisplay:"auto",min:2,disabled:c,value:pe,onChange:function(e,a){return he(a)}})]}))]})),Object(X.jsxs)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:[Object(X.jsxs)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:[Object(X.jsxs)("div",{className:"form-item-name",children:[a("form.layout.rowSpaceLabel")," (mm):"]}),Object(X.jsx)(v.a,{"aria-label":a("form.layout.rowSpaceLabel"),valueLabelDisplay:"auto",min:1,disabled:c,value:Se,onChange:function(e,a){return Ce(a)}})]})),Object(X.jsxs)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:[Object(X.jsxs)("div",{className:"form-item-name",children:[a("form.layout.colSpaceLabel")," (mm):"]}),Object(X.jsx)(v.a,{"aria-label":a("form.layout.colSpaceLabel"),valueLabelDisplay:"auto",min:1,disabled:c,value:Ie,onChange:function(e,a){return Fe(a)}})]}))]})),Object(X.jsxs)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:[Object(X.jsxs)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:[Object(X.jsxs)("div",{className:"form-item-name",children:[a("form.layout.rotateLabel")," (\xb0):"]}),Object(X.jsx)(v.a,{"aria-label":a("form.layout.rotateLabel"),valueLabelDisplay:"auto",min:0,max:360,disabled:c,value:Te,onChange:function(e,a){return Ee(a)}})]})),Object(X.jsxs)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:[Object(X.jsxs)("div",{className:"form-item-name",children:[a("form.layout.rowShiftLabel")," (mm):"]}),Object(X.jsx)(v.a,{"aria-label":a("form.layout.rowShiftLabel"),valueLabelDisplay:"auto",min:0,disabled:c,value:Re,onChange:function(e,a){return Qe(a)}})]}))]})),Object(X.jsx)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:Object(X.jsxs)(d.a,Object(o.a)(Object(o.a)({},_),{},{children:[Object(X.jsx)(g.a,{fullWidth:!0,label:a("form.backgroundImage"),variant:"standard",InputLabelProps:{shrink:!0},type:"file",disabled:c,onChange:ca}),Object(X.jsx)(x.a,{disabled:c,onClick:ia,children:a("form.print")})]}))})),Object(X.jsx)(w.a,{className:"progress-indicator",style:{opacity:c?1:0}})]}),Object(X.jsx)(j.a,{className:"canvas-container",id:Y,onContextMenu:fa}),Object(X.jsxs)(L.a,{open:!!ua,onClose:ja,anchorReference:"anchorPosition",anchorPosition:ua,children:[Object(X.jsx)(m.a,{onClick:da,children:a("form.print")}),Object(X.jsx)(m.a,{onClick:pa,children:a("form.download")})]})]})}var Z=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,173)).then((function(a){var t=a.getCLS,n=a.getFID,r=a.getFCP,c=a.getLCP,l=a.getTTFB;t(e),n(e),r(e),c(e),l(e)}))},$=t(156);i.a.render(Object(X.jsx)(c.a.StrictMode,{children:Object(X.jsx)($.a,{i18n:A,children:Object(X.jsx)(G,{})})}),document.getElementById("root")),Z()},66:function(e){e.exports=JSON.parse('{"title":"\u6c34\u5370\u9635\u5217","form":{"style":{"i18nClass":"i18n-zh i18n-zhCN"},"languageLabel":"Language","paperSizeLabel":"\u7eb8\u5f20\u5927\u5c0f","printQuality":"\u6253\u5370\u7cbe\u5ea6","waterMarkerText":"\u6c34\u5370\u5185\u5bb9","font":{"familyLabel":"\u5b57\u4f53\u7c7b\u578b","weightLabel":"\u5b57\u91cd","colorLabel":"\u5b57\u4f53\u989c\u8272","sizeLabel":"\u5b57\u4f53\u5927\u5c0f"},"layout":{"rowSpaceLabel":"\u6c34\u5e73\u95f4\u9694","colSpaceLabel":"\u5782\u76f4\u95f4\u9694","rotateLabel":"\u65cb\u8f6c\u89d2\u5ea6","rowShiftLabel":"\u6c34\u5e73\u504f\u79fb"},"backgroundImage":"\u80cc\u666f\u56fe\u7247","print":"\u6253\u5370","download":"\u4e0b\u8f7d\u56fe\u7247"}}')},67:function(e){e.exports=JSON.parse('{"title":"\u6c34\u5370\u9663\u5217","form":{"style":{"i18nClass":"i18n-zh i18n-zhTW"},"languageLabel":"Language","paperSizeLabel":"\u7d19\u5f35\u5927\u5c0f","printQuality":"\u6253\u5370\u7cbe\u5ea6","waterMarkerText":"\u6c34\u5370\u5167\u5bb9","font":{"familyLabel":"\u5b57\u9ad4\u985e\u578b","weightLabel":"\u5b57\u91cd","colorLabel":"\u5b57\u9ad4\u984f\u8272","sizeLabel":"\u5b57\u9ad4\u5927\u5c0f"},"layout":{"rowSpaceLabel":"\u6c34\u5e73\u9593\u9694","colSpaceLabel":"\u5782\u76f4\u9593\u9694","rotateLabel":"\u65cb\u8f49\u89d2\u5ea6","rowShiftLabel":"\u6c34\u5e73\u504f\u79fb"},"backgroundImage":"\u80cc\u666f\u5716\u7247","print":"\u6253\u5370","download":"\u4e0b\u8f09\u5716\u7247"}}')},82:function(e){e.exports=JSON.parse('{"title":"Water Marker Array","form":{"style":{"i18nClass":"i18n-en"},"languageLabel":"\u8bed\u8a00","paperSizeLabel":"Paper","printQuality":"Print Quality","waterMarkerText":"Text","font":{"familyLabel":"Font Family","weightLabel":"Font Weight","colorLabel":"Font Color","sizeLabel":"Font Size"},"layout":{"rowSpaceLabel":"Row Space","colSpaceLabel":"Col Space","rotateLabel":"Rotate","rowShiftLabel":"Row Shift"},"backgroundImage":"Image","print":"Print","download":"Save as Image"}}')}},[[116,1,2]]]);